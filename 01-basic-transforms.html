<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        html, body {
            height: 100%;
            margin: 0;
            overflow: hidden;
        }
    </style>
    <title>Joy of Math</title>
</head>
<body>
<canvas id="canvas"></canvas>
<script src="gl-matrix.js"></script>
<script>
const canvas = document.getElementById("canvas");
canvas.width = window.innerWidth;
canvas.height = window.innerHeight;
const ctx = canvas.getContext("2d");

const { mat3, vec2 } = glMatrix;

const vertices = [
    [-1, 1],
    [0, -1],
    [1, 1]
];

const triangles = [{
    color: [255, 0, 0]
}];

let startTime = performance.now(); 
requestAnimationFrame(function loop() {
    requestAnimationFrame(loop);

    const t = (startTime - performance.now()) * 0.001;

    ctx.fillStyle = "black";
    ctx.fillRect(0, 0, canvas.width, canvas.height);

    triangles.forEach(tri => {
        const transformedVertices = vertices.map(v => {
            let [x, y] = v;

            x *= 20;
            y *= 20;

            x += canvas.width / 2;
            y += canvas.height / 2;

            return [
                x,
                y
            ];
        });

        ctx.fillStyle = `rgb(${tri.color.join(",")})`;
        ctx.beginPath();
        ctx.moveTo(...transformedVertices[0]);
        transformedVertices.slice(1).forEach(v => ctx.lineTo(...v));
        ctx.closePath();
        ctx.fill();
    })
});

let dragging = false;
let lastMouse = [0, 0];
canvas.addEventListener("mousedown", (event) => {
    dragging = true;
    vec2.set(lastMouse, event.clientX, event.clientY);
});

canvas.addEventListener("mousemove", (event) => {
    if (dragging) {
        const mouse = [event.clientX, event.clientY];
        const delta = vec2.subtract([0, 0], mouse, lastMouse);
        vec2.copy(lastMouse, mouse);
        
        
    }
});

window.addEventListener("mouseup", (event) => {
    dragging = false;
});

</script>
</body>
</html>